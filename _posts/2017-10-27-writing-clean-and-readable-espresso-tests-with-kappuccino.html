---
layout: post
title: Writing clean and readable Espresso tests with Kappuccino
tag:
- android
- software-testing
- ui-testing
- kotlin
---

<figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*_KXqNj3-AKy4eLa6HqXJLg.png" /></figure><p>Using Espresso to write your UI tests can be quite repetitive and, as a consequence, boring. Most of the time you end up repeating the same methods a lot of times and you have to write a lot of code to make a simple task in your UI:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*aanpYt1jNyWmKyO2McEfdQ.png" /><figcaption>When user types a not registered e-mail, the app shows register form.</figcaption></figure><p>Did you notice how many times the methods <em>onView, withId, check, matches, isDisplayed</em> are repeated? That makes the code quite confusing to read and maintain. If you notice, the only thing that changes between each line, is the <em>id</em> of the view that you want to check the visibility.</p><p>What if we could write this test in a more concise, easy and clean way? Like this:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/549/1*wjzVyVQZjqJMxMJxwAZrIQ.png" /><figcaption>Same test, more readable</figcaption></figure><p>Well, now with <a href="https://github.com/heitorcolangelo/kappuccino">Kappuccino</a> you can!</p><p>When you write all of this lines of code</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/763/1*N0OpkopS_n5zlxMgGHjMTA.png" /></figure><p>All you really want to do is: check if the views with these <em>ids</em> (in purple) are displayed on the screen. So we used this idea and create a library so you can write your tests following this principle.</p><p>You can match the views with a lot of different matches:</p><ul><li>id (as the example above)</li><li>text (passing a String, StringRes id or String matcher as parameter)</li><li>contentDescription</li><li>image</li><li>background</li><li>textColor</li><li>parent</li><li>descendant</li><li>or a custom matcher if you need.</li></ul><p>Also, kappuccino provides a lot of custom matchers that are commonly used during UI tests, making your task to write them much easier. For example, interact with a RecyclerView is simple like this:</p><iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/d4acdcbc9aab92b7b28f88155df7c88a/href">https://medium.com/media/d4acdcbc9aab92b7b28f88155df7c88a/href</a></iframe><p>And much more!</p><ul><li>Handle RuntimePermissions</li><li>IntentMatcher</li><li>Background Matcher</li><li>TextColor Matcher</li><li>Drawable Matcher (roadmap)</li></ul><p>You can add kappuccino by adding this to your project:</p><pre>androidTestCompile &#39;br.com.concretesolutions:kappuccino:1.0.6&#39;</pre><p>Feel free to fork us on <a href="https://github.com/concretesolutions/kappuccino">GitHub</a>, test in your project and give us some feedback!<br>Thanks!</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=60cfb29d96a0" width="1" height="1" alt="">
